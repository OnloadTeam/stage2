<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Task26</title>
    <script src="ToolKit.js"></script>
    <link rel="stylesheet" href="task26.css" >
</head>

<body>
<div id="control-panel">
    <div id="control-title">Control Panel</div>
    <div id="control-main">
        <div data-id="1">
            <span>Orbit-1</span>
            <button type="button" data-type="create" data-status="create">Create </button>
            <button type="button" data-type="drive" data-status="start" disabled="disabled">Start</button>
            <input type="number" title="Speed" value="20" disabled="disabled">
            <button type="button" data-type="rate" disabled="disabled">Apply</button>
        </div>
        <div data-id="2">
            <span>Orbit-2</span>
            <button type="button" data-type="create" data-status="create">Create</button>
            <button type="button" data-type="drive" data-status="start" disabled="disabled">Start</button>
            <input type="number" title="Speed" value="20" disabled="disabled">
            <button type="button" data-type="rate" disabled="disabled">Apply</button>
        </div>
        <div data-id="3">
            <span>Orbit-3</span>
            <button type="button" data-type="create" data-status="create">Create</button>
            <button type="button" data-type="drive" data-status="start" disabled="disabled">Start</button>
            <input type="number" title="Speed" value="20" disabled="disabled">
            <button type="button" data-type="rate" disabled="disabled">Apply</button>
        </div>
        <div data-id="4">
            <span>Orbit-4</span>
            <button type="button" data-type="create" data-status="create">Create</button>
            <button type="button" data-type="drive" data-status="start" disabled="disabled">Start</button>
            <input type="number" title="Speed" value="20" disabled="disabled">
            <button type="button" data-type="rate" disabled="disabled">Apply</button>
        </div>
    </div>
</div>

<div id="console">
    <div id="console-title">Console</div>
    <div id="console-text"></div>
</div>

<div id="planet"></div>
<div id="orbit-1" class="orbit"></div>
<div id="orbit-2" class="orbit"></div>
<div id="orbit-3" class="orbit"></div>
<div id="orbit-4" class="orbit"></div>
<script>
    function getTime() {
        var date = new Date();
        var year = date.getFullYear();
        var month = date.getMonth() + 1;
        var day = date.getDate();
        var hour = date.getHours();
        var minute = date.getMinutes();
        var second = date.getSeconds();
        if(minute<10){
            minute="0"+minute;
        }
        if(second<10){
            second="0"+second;
        }
        return year + "-" + month + "-" + day + " " + hour + ":" + minute + ":" + second;
    }

    var consoleText = document.getElementById("console-text");

    function Log(BoardID) {
        this.Board=document.getElementById(BoardID);
        this.print=function (message,color) {
            var p = document.createElement("p");
            p.innerText = getTime() + " ";

            var span = document.createElement("span");
            span.innerText = message;
            span.style.color = color;

            p.appendChild(span);
            this.Board.appendChild(p);
            this.Board.scrollTop=this.Board.scrollHeight;
        }
    }
    function log(message, color) {
        var p = document.createElement("p");
        p.innerText = getTime() + " ";

        var span = document.createElement("span");
        span.innerText = message;
        span.style.color = color;

        p.appendChild(span);
        consoleText.appendChild(p);

        console.log(message);
        consoleText.scrollTop = consoleText.scrollHeight;
    }
    FloatWindow("control-panel", "control-title", 0, EPosition.BOTTOM);
    FloatWindow("console", "console-title", EPosition.RIGHT, EPosition.BOTTOM);

    (function () {
        var buttonClick = function () {
            var orbitID = parseInt(this.parentNode.dataset.id);
            var message = this.dataset.type;
            console.log("buttonClick:" + message + ":" + orbitID);
            switch (message) {
                case "create":
                    if (this.dataset.status == 'create') {
                        Planet.createSpaceship(orbitID);
                        this.dataset.status = "created";
                        this.innerText = "Destroy";
                        this.nextElementSibling.disabled = false;
                        this.nextElementSibling.nextElementSibling.disabled = false;
                        this.nextElementSibling.nextElementSibling.nextElementSibling.disabled = false
                    }
                    else {
                        Planet.destroy(orbitID);
                        this.dataset.status = 'create';
                        this.innerText = "Create ";
                        this.nextElementSibling.disabled = true;
                        this.nextElementSibling.dataset.status = "start";
                        this.nextElementSibling.innerText = "Start";
                        this.nextElementSibling.nextElementSibling.disabled = true;
                        this.nextElementSibling.nextElementSibling.value = 1;
                        this.nextElementSibling.nextElementSibling.nextElementSibling.disabled = true;
                    }
                    break;
                case "drive":
                    if (this.dataset.status == "start") {
                        Planet.start(orbitID);
                        this.dataset.status = "stop";
                        this.innerText = "Stop";
                    }
                    else {
                        Planet.stop(orbitID);
                        this.dataset.status = "start";
                        this.innerText = "Start";
                    }
                    break;
                case "rate":
                    var value = parseInt(this.previousElementSibling.value);
                    Planet.setRate(orbitID, value);
                    break;
            }
        };

        var buttons = document.getElementsByTagName("button");
        for (var i = 0; i < buttons.length; i++) {
            buttons[i].onclick = buttonClick;
        }
    })();
</script>

<script src="Planet.js"></script>
<script src="SpaceManager.js"></script>
<script src="Spaceship.js"></script>
</body>
</html>